<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Preventi Flow</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>
        /* ... (todo el CSS original del usuario) ... */
        /* --- CHAT FLOTANTE CENTRADO Y TRANSPARENTE --- */
        #chat-widget-preventi {
          position: fixed;
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%);
          width: 360px;
          max-width: 95vw;
          height: 480px;
          background: transparent;
          border-radius: 18px 18px 12px 12px;
          box-shadow: none;
          font-family: 'Inter', 'Montserrat', Arial, sans-serif;
          font-size: 15px;
          color: #f3f3f3;
          display: flex;
          flex-direction: column;
          overflow: visible;
          z-index: 99999;
          border: none;
          transition: box-shadow 0.2s;
          animation: fadein 0.7s cubic-bezier(.4,1.3,.6,1);
        }
        #chat-header-preventi {
          background: linear-gradient(90deg, #23243a 60%, #1a1b23 100%);
          color: #fff;
          font-weight: 600;
          font-size: 17px;
          border-radius: 18px 18px 0 0;
          padding: 16px 24px;
          letter-spacing: 0.01em;
          text-align: left;
        }
        #chat-messages-preventi {
          flex: 1;
          padding: 22px 18px 12px 18px;
          background: rgba(24,24,36,0.94);
          border-radius: 0 0 0 0;
          overflow-y: auto;
          font-size: 15px;
        }
        .user-msg {
          background: linear-gradient(90deg,#5eead4 60%,#60a5fa 100%);
          color: #23263a;
          padding: 9px 16px;
          border-radius: 16px 16px 4px 16px;
          margin-bottom: 10px;
          max-width: 85%;
          align-self: flex-end;
          box-shadow: 0 2px 8px 0 rgba(30,40,100,0.08);
          word-break: break-word;
        }
        .ai-msg {
          background: #23263a;
          color: #fff;
          padding: 9px 16px;
          border-radius: 16px 16px 16px 4px;
          margin-bottom: 10px;
          max-width: 85%;
          align-self: flex-start;
          box-shadow: 0 2px 12px 0 rgba(30,40,100,0.09);
          word-break: break-word;
        }
        #chat-input-area-preventi {
          padding: 18px 18px 18px 18px;
          background: rgba(24,24,36,0.97);
          border-radius: 0 0 12px 12px;
          display: flex;
          gap: 12px;
          align-items: center;
        }
        #chat-input-preventi {
          flex: 1;
          border-radius: 12px;
          border: none;
          background: #23263a;
          color: #fff;
          font-size: 16px;
          padding: 12px 16px;
          outline: none;
          box-shadow: 0 2px 8px 0 rgba(30,40,100,0.08);
        }
        #chat-input-preventi::placeholder {
          color: #b0b5d2;
        }
        #chat-send-btn-preventi {
          background: linear-gradient(90deg,#5eead4 60%,#60a5fa 100%);
          color: #23263a;
          border: none;
          border-radius: 12px;
          padding: 10px 18px;
          font-weight: 600;
          font-size: 15px;
          cursor: pointer;
          transition: background 0.18s;
        }
        #chat-send-btn-preventi:hover {
          background: linear-gradient(90deg,#60a5fa 60%,#5eead4 100%);
        }
        @keyframes fadein {
          from { opacity: 0; transform: scale(0.95) translate(-50%, -50%); }
          to { opacity: 1; transform: scale(1) translate(-50%, -50%); }
        }
        @media (max-width: 480px) {
          #chat-widget-preventi {
            width: 98vw;
            min-width: unset;
            height: 95vh;
            max-height: 98vh;
            border-radius: 14px;
          }
        }
    </style>
</head>
<body class="">
    <div class="bg-animated"></div>
    <div class="sidebar-overlay" id="sidebarOverlay"></div>
    <aside class="sidebar" id="sidebar">
        <button class="sidebar-close-btn" id="sidebarCloseBtn" aria-label="Cerrar menú">
            <svg viewBox="0 0 24 24" fill="none"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
        </button>
        <div class="sidebar-header">
            <img class="sidebar-logo object-cover" src="https://images.unsplash.com/photo-1636690598773-c50645a47aeb?w=320&amp;q=80" alt="Preventi Logo" style="">
            <span class="sidebar-brand font-playfair">Preventi Flow</span>
        </div>
        <div class="sidebar-content">
            <button class="sidebar-btn scale-90 justify-center">+   Nuevo Chat</button>
            <div class="sidebar-section">
                <span class="sidebar-section-title translate-x-3">Consultas recientes</span>
                <div class="sidebar-chats"></div>
            </div>
            <div class="sidebar-section">
                <span class="sidebar-section-title translate-x-4">Herramientas</span>
                <div class="sidebar-menu">
                    <div class="sidebar-menu-link" tabindex="0">
                        <svg viewBox="0 0 24 24" fill="none" stroke-width="1.5" class=""><rect x="3" y="3" width="18" height="18" rx="4"></rect><path d="M9 9h6v6H9z"></path></svg>
                        Inspecciones
                        <div class="submenu-pop">
                            <div class="submenu-item">Crear Inspección</div>
                            <div class="submenu-item">Ver Historial</div>
                        </div>
                    </div>
                    <div class="sidebar-menu-link" tabindex="0">
                        <svg viewBox="0 0 24 24" fill="none" stroke-width="1.5" class=""><circle cx="12" cy="12" r="10"></circle><path d="M8 12h8"></path></svg>
                        Capacitaciones
                        <div class="submenu-pop">
                            <div class="submenu-item">Nuevo Curso</div>
                            <div class="submenu-item">Progreso</div>
                        </div>
                    </div>
                    <div class="sidebar-menu-link" tabindex="0">
                        <svg viewBox="0 0 24 24" fill="none" stroke-width="1.5" class=""><rect x="3" y="3" width="18" height="18" rx="4" class=""></rect><path d="M8 8h8v8H8z"></path></svg>
                        Estadísticas
                        <div class="submenu-pop">
                            <div class="submenu-item">Reportes Generales</div>
                            <div class="submenu-item">Métricas Clave</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </aside>
    <header class="mobile-header">
        <button class="hamburger-btn" id="hamburgerBtn" aria-label="Abrir menú">
             <svg viewBox="0 0 24 24" fill="none"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg>
        </button>
        <div class="mobile-header-brand">
            <img class="mobile-logo" src="https://assets-global.website-files.com/65499595955047585672910d/654999330551061f21136b6f_Logo.png" alt="Preventi Logo" style="">
            <span class="sidebar-brand">Preventi Flow</span>
        </div>
    </header>
    <main class="main-content">
        <nav class="toolbar" id="toolbar">
            <div class="toolbar-icons">
                <button class="toolbar-icon-btn" title="Configuración">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-[24px] h-[24px]" style="width: 24px; height: 24px; color: rgb(22, 29, 42);"><path d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"></path><circle cx="12" cy="12" r="3"></circle></svg>
                </button>
                <button class="toolbar-icon-btn" title="Alertas">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-[24px] h-[24px]" style="width: 24px; height: 24px; color: rgb(255, 255, 255);"><path d="M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9"></path><path d="M10.3 21a1.94 1.94 0 0 0 3.4 0"></path></svg>
                </button>
                <button class="toolbar-icon-btn" title="Modo claro/oscuro" id="themeToggle">
                    <svg id="themeIconSun" viewBox="0 0 24 24" fill="none" style="display: none;"><circle cx="12" cy="12" r="5"></circle><path d="M12 1v2m0 18v2M4.22 4.22l1.42 1.42m12.72 12.72l1.42 1.42M1 12h2m18 0h2M4.22 19.78l1.42-1.42m12.72-12.72l1.42-1.42"></path></svg>
                    <svg id="themeIconMoon" viewBox="0 0 24 24" fill="none" style="display: block;" class=""><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z" class=""></path></svg>
                </button>
                <button class="toolbar-icon-btn user-btn" id="userBtn" tabindex="0">
                    <svg viewBox="0 0 24 24" fill="none" class="w-[24px] h-[24px]" stroke-width="2" style="width: 24px; height: 24px; color: rgb(255, 255, 255);"><circle cx="12" cy="7" r="4" class=""></circle><path d="M5.5 21a8.38 8.38 0 0 1 13 0"></path></svg>
                    <div class="user-menu-pop">
                        <a href="#" class="user-menu-link">Cuenta</a>
                        <a href="#" class="user-menu-link">Perfil</a>
                        <a href="#" class="user-menu-link">Logout</a>
                    </div>
                </button>
            </div>
        </nav>
        <div class="chatbox-container"></div>
        <!-- INICIO CHAT FLOTANTE CENTRADO -->
        <div id="chat-widget-preventi">
          <div id="chat-header-preventi">Preventi Chat</div>
          <div id="chat-messages-preventi">
            <div class="ai-msg">¡Hola! ¿En qué puedo ayudarte?</div>
          </div>
          <div id="chat-input-area-preventi">
            <input id="chat-input-preventi" placeholder="Escribe tu mensaje..." autocomplete="off" />
            <button id="chat-send-btn-preventi">Enviar</button>
          </div>
        </div>
        <!-- FIN CHAT FLOTANTE CENTRADO -->
    </main>
    <script>
    // Lógica sidebar y temas (igual que tu código original)
    document.addEventListener('DOMContentLoaded', () => {
        const sidebar = document.getElementById('sidebar');
        const overlay = document.getElementById('sidebarOverlay');
        const hamburgerBtn = document.getElementById('hamburgerBtn');
        const closeBtn = document.getElementById('sidebarCloseBtn');
        const menuLinks = document.querySelectorAll('.sidebar-menu-link');
        const toggleSidebar = (visible) => {
            sidebar.classList.toggle('visible', visible);
            overlay.classList.toggle('visible', visible);
        };
        hamburgerBtn.addEventListener('click', (e) => { e.stopPropagation(); toggleSidebar(true); });
        closeBtn.addEventListener('click', () => toggleSidebar(false));
        overlay.addEventListener('click', () => toggleSidebar(false));
        menuLinks.forEach(link => {
            link.addEventListener('click', (e) => {
                if (window.innerWidth <= 768) {
                    e.preventDefault();
                    let wasOpen = link.classList.contains('open');
                    menuLinks.forEach(l => l.classList.remove('open'));
                    if (!wasOpen) {
                        link.classList.add('open');
                    }
                }
            });
        });
        const themeToggle = document.getElementById('themeToggle');
        const sunIcon = document.getElementById('themeIconSun');
        const moonIcon = document.getElementById('themeIconMoon');
        const setTheme = (theme) => {
            document.documentElement.setAttribute('data-theme', theme);
            localStorage.setItem('pf-theme', theme);
            sunIcon.style.display = theme === 'light' ? 'block' : 'none';
            moonIcon.style.display = theme === 'dark' ? 'block' : 'none';
        };
        themeToggle.addEventListener('click', () => {
            const currentTheme = document.documentElement.getAttribute('data-theme');
            setTheme(currentTheme === 'dark' ? 'light' : 'dark');
        });
        const initialTheme = localStorage.getItem('pf-theme') || 'dark';
        setTheme(initialTheme);
    });
    // Lógica del chat flotante Preventi
    (function() {
      const chatWidget = document.getElementById('chat-widget-preventi');
      const chatMessages = document.getElementById('chat-messages-preventi');
      const chatInput = document.getElementById('chat-input-preventi');
      const chatSendBtn = document.getElementById('chat-send-btn-preventi');
      function renderMessage(msg, sender = 'user') {
        const div = document.createElement('div');
        div.className = sender === 'user' ? 'user-msg' : 'ai-msg';
        div.textContent = msg;
        chatMessages.appendChild(div);
        chatMessages.scrollTop = chatMessages.scrollHeight;
      }
      function sendUserMessage() {
        const msg = chatInput.value.trim();
        if (!msg) return;
        renderMessage(msg, 'user');
        chatInput.value = '';
        setTimeout(() => {
          renderMessage('¡Recibido! Esto es una respuesta simulada.', 'ai');
        }, 900);
      }
      chatSendBtn.addEventListener('click', sendUserMessage);
      chatInput.addEventListener('keydown', function(e) {
        if (e.key === 'Enter') {
          e.preventDefault();
          sendUserMessage();
        }
      });
    })();
    </script>
</body>
</html>
      let step = 0;
      function renderMessage(msg) {
        const div = document.createElement('div');
        div.className = msg.role === 'user' ? 'user-msg' : 'ai-msg';
        div.textContent = msg.content;
        chatMessages.appendChild(div);
        chatMessages.scrollTop = chatMessages.scrollHeight;
      }
      function sendUserMessage() {
        const text = chatInput.value.trim();
        if (!text) return;
        renderMessage({ role: 'user', content: text });
        chatInput.value = '';
        step++;
        // Mostrar "pensando..."
        const thinking = document.createElement('div');
        thinking.className = 'ai-msg';
        thinking.style.opacity = '0.6';
        thinking.textContent = 'Pensando…';
        chatMessages.appendChild(thinking);
        chatMessages.scrollTop = chatMessages.scrollHeight;
        setTimeout(() => {
          thinking.remove();
          let aiContent = '';
          if (step === 1) {
            const frase = frasesAceptacion[Math.floor(Math.random() * frasesAceptacion.length)];
            aiContent = frase + ' ' + text;
          } else {
            aiContent = 'Respuesta generada a: ' + text;
          }
          renderMessage({ role: 'ai', content: aiContent });
        }, 900);
      }
      chatSendBtn.addEventListener('click', sendUserMessage);
      chatInput.addEventListener('keydown', function(e) {
        if (e.key === 'Enter') {
          e.preventDefault();
          sendUserMessage();
        }
      });
    })();
    </script>
</body>
</html>
